/*! duplexchicks 2016-07-27 */
var chickApp=angular.module("chickApp",["ngMaterial","ngMessages","ngRoute","googlechart"]);chickApp.config(["$routeProvider","$locationProvider",function(a,b){}]);var chickAppAdmin=angular.module("chickAppAdmin",["ngMaterial","ngMessages","ngRoute","md.data.table"]);chickAppAdmin.config(["$routeProvider","$locationProvider",function(a,b){a.when("/admin",{templateUrl:"/views/admin.html",controller:"AdminController"}).when("/emailList",{templateUrl:"/views/partials/emailList.html",controller:"EmailController"}).when("/setVariables",{templateUrl:"/views/partials/setVariables.html",controller:"SetVariablesController"}).otherwise({redirectTo:"/emailList"})}]);var chickAppRegistration=angular.module("chickAppRegistration",["ngMaterial","ngRoute"]);chickAppRegistration.config(["$routeProvider","$locationProvider",function(a,b){}]);var chickAppLogin=angular.module("chickAppLogin",["ngMaterial","ngRoute"]);chickAppLogin.config(["$routeProvider","$locationProvider",function(a,b){}]),chickAppAdmin.controller("AdminController",["$scope","$http","$window","AdminService",function(a,b,c,d){a.toEmailList=function(){c.location.href="#emailList"},a.toDefaultValues=function(){c.location.href="#setVariables"}}]),chickAppAdmin.controller("EmailController",["$scope","$http","$window","AdminService","$mdDialog",function(a,b,c,d,e){"use strict";a.selected=[],a.limitOptions=[5,10,15],a.query={order:"date",limit:5,page:1},a.getContacts=function(){b.get("/submit").then(function(b){a.emailList=b.data,console.log(a.emailList),a.count=a.emailList.length})},a.getContacts(),a.toggleLimitOptions=function(){a.limitOptions=a.limitOptions?void 0:[5,10,15]},a.loadStuff=function(){a.promise=$timeout(function(){},2e3)},a.logItem=function(a){console.log(a.name,"was selected")},a.logOrder=function(a){console.log("order: ",a)},a.logPagination=function(a,b){console.log("page: ",a),console.log("limit: ",b)},a.changeStatus=function(a){console.log("Changing status of contact with id: ",a)},a.deleteContact=function(b){var c=e.confirm().title("Are you sure you want to delete this contact?").ok("Yes").cancel("No");e.show(c).then(function(){console.log("Yes"),d.deleteTheContact(b),a.getContacts()},function(){console.log("No")})},a.changeStatus=function(b){var c=e.confirm().title('Are you sure you want to mark contact as "Contacted"?').ok("Yes").cancel("No");e.show(c).then(function(){console.log("Yes"),d.updateTheContact(b),a.getContacts()},function(){console.log("No")})},a.changeStatusBack=function(b){var c=e.confirm().title('Are you sure you want to mark contact as "Not Contacted"?').ok("Yes").cancel("No");e.show(c).then(function(){console.log("Yes"),d.updateTheContactBack(b),a.getContacts()},function(){console.log("No")})}}]),chickAppAdmin.controller("SetVariablesController",["$scope","$http","$window","AdminService",function(a,b,c,d){a.getDefaults=function(){b.get("/defaults").then(function(b){a.defaultVariables=b.data[0],d.admin.defaults=a.defaultVariables})},a.getDefaults(),a.setDefaultValues=function(a){d.alterDefaults(a)}}]),chickApp.controller("InputController",["$scope","$log","$http","$window","$mdSidenav","$mdDialog","$mdMedia","ClientService",function(a,b,c,d,e,f,g,h){var i=h;a.toggleMenu=function(){e("left").toggle()},a.inputData={},a.minMax={},a.getDefaults=function(){c.get("/defaults").then(function(b){defaultVariables=b.data[0],a.minMax=defaultVariables,a.inputData.monthlyRentPersonal=defaultVariables.monthlyRentPersonalDef,a.inputData.monthlyRentTenant=defaultVariables.monthlyRentTenantDef,a.inputData.targetPrice=defaultVariables.targetPriceDef,a.inputData.downPaymentPercentage=defaultVariables.downPaymentPercentageDef,a.inputData.mortgageRate=defaultVariables.mortgageRateDef,a.inputData.yearsAmmoritized=defaultVariables.yearsAmmoritizedDef,a.inputData.income=defaultVariables.incomeDef,a.inputData.mortgageYears=defaultVariables.mortgageYearsDef,a.inputData.vacancy=defaultVariables.vacancyDef,a.inputData.propertyTax=defaultVariables.propertyTaxDef,a.inputData.assocDues=defaultVariables.assocDuesDef,a.inputData.management=defaultVariables.managementDef,a.inputData.misc=defaultVariables.miscDef,a.inputData.insuranceAnnual=defaultVariables.insuranceAnnualDef,a.inputData.utils=defaultVariables.utilsDef,a.inputData.legalAccounting=defaultVariables.legalAccountingDef,a.inputData.taxBracket=defaultVariables.taxBracketDef,a.inputData.repairValue=defaultVariables.repairValueDef,a.inputData.years=defaultVariables.yearsDef,a.inputData.maritalStatus=!1,a.inputData.zipCode=defaultVariables.zipCode,a.inputData.appreciationRate=defaultVariables.appreciationRateDef,a.inputData.appreciationRateHome=defaultVariables.appreciationRateHomeDef,a.inputData.renterInsurance=defaultVariables.renterInsuranceDef,a.inputData.duplexBuy=defaultVariables.duplexBuyDef})},a.getDefaults(),console.log("duplexBuy",a.inputData.duplexBuy);a.$watchCollection("inputData",function(b,c){console.log(b,"newval"),console.log("duplexBuy",a.inputData.duplexBuy);var d=function(a){return 0==b.maritalStatus?b.income<=9225?incomeTax=10:b.income<=37450?incomeTax=15:b.income<=90750?incomeTax=25:b.income<=189300?incomeTax=28:b.income<=411500?incomeTax=33:b.income<=411500?incomeTax=33:b.income<=413200?incomeTax=35:incomeTax=39.6:b.income<=18450?incomeTax=10:b.income<=74900?incomeTax=15:b.income<=181500?incomeTax=25:b.income<=378600?incomeTax=28:b.income<=823e3?incomeTax=33:b.income<=823e3?incomeTax=33:b.income<=826400?incomeTax=35:incomeTax=39.6,incomeTax},e=function(){var a=d();return 10==a?cGT=10:15==a?cGT=15:cGT=25,cGT};console.log(e(),"asd");var f=function(a){var c=a-a*b.downPaymentPercentage/100;return c},g=function(a,c){hold=b.mortgageRate/12/100*f(c);var d=Math.pow(1+b.mortgageRate/12/100,-1*a);return monthPay=hold/(1-d),monthPay},h=function(a){var c=.006*a,d=100,e=b.propertyTax+c+b.utils+d+b.insuranceAnnual;return e/12},i=function(a,b,c){var d=f(b),e=1+c/12/100,g=a,h=d*Math.pow(e,g);return h-=f(b)},j=function(a){var c=a*b.duplexBuy*(.05*.2);c>=.05*b.duplexBuy&&(c=.05*b.duplexBuy);var d=a*b.duplexBuy*.0174;d>=.5*b.duplexBuy&&(d=.5*b.duplexBuy);var e=a*b.duplexBuy*(.05*.2);e>=.2*b.duplexBuy&&(e=.2*b.duplexBuy);var f=e+d+c,f=f/12/2;return f},k=function(a){return rent=b.monthlyRentTenant*a,insurance=b.renterInsurance*a,rentTot=rent+insurance+b.utils*a,rentTot},l=function(a){return rent=b.monthlyRentPersonal*a,rent*=1-d()/100,rent};console.log(l(b.years),"rentFunction");var m=function(a){var c=g(12*b.mortgageYears,a),d=h(a),e=d+c;return e},n=function(a){var b=h(a);return b},o=function(a,c,d){return downPayment=b.downPaymentPercentage/100*c,a<=12*b.mortgageYears?normalPay=m(c)*a:(firstPart=m(c)*b.mortgageYears*12,secondPart=(12*b.mortgageYears-a)*n(c),normalPay=firstPart+secondPart),totalPay=normalPay+downPayment-i(a,c,d),totalPay},p=function(a,b,c){var d=o(a,b,c),e=j(a),f=k(a),g=d-e-f;return g};console.log(p(12*b.years,b.duplexBuy,b.appreciationRate),"duplex Function"),a.buy[1].v=Math.floor(o(12*b.years,b.targetPrice,b.appreciationRateHome)),console.log(a.buy[1].v,"buy"),a.rent[1].v=Math.floor(l(12*b.years)),console.log(a.rent[1].v,"rent"),a.buyAndRent[1].v=Math.floor(p(12*b.years,b.duplexBuy,b.appreciationRate)),console.log(a.buyAndRent[1].v,"duplex");var q=function(){console.log("horse hockey"),console.log(a.buy,a.rent,a.buyAndRent),a.buy[1].v<a.rent[1]&&a.buy[1].v<a.buyAndRent[1].v&&(a.topMessage="save money by buying."),a.rent[1].v<a.buy[1].v&&a.rent[1].v<a.buyAndRent[1].v&&(a.topMessage="save money by renting."),a.buyAndRent[1].v<a.rent[1].v&&a.buyAndRent[1].v<a.buy[1].v&&(a.topMessage="earn $"+-1*Math.floor(a.buyAndRent[1].v)+" by investing in a duplex!")};q(),a.buyValues=[],a.rentValues=[],a.buyAndRentValues=[],count=0;var r=function(){for(var c=0;c<12*b.years;c++)count++,a.buyValues.push(o(c,b.targetPrice,b.appreciationRateHome)),a.buyAndRentValues.push(p(c,b.duplexBuy,b.appreciationRate)),a.rentValues.push(l(c))};r();var s=[],t=function(){for(var c=0;c<12*b.years;c++){var d={c:[{v:c},{v:a.rentValues[c]},{v:a.buyValues[c]},{v:a.buyAndRentValues[c]}]};s.push(d)}};t(),a.hiddenChartObject={type:"LineChart",data:{cols:[{id:"year",label:"Years",type:"string"},{id:"buy-line",label:"Rent",type:"number"},{id:"rent-line",label:"Buy",type:"number"},{id:"buyAndRent-line",label:"Duplex",type:"number"}],rows:s},options:{title:"Cost Of Investment Over Time",isStacked:!0,fill:20,displayExactValues:!0,vAxis:{title:"Return"},hAxis:{title:"Months"},animation:{duration:300,easing:"out"},colors:["lightblue","blue","rgb(255,64,129)"]},formatters:{}}}),a.$watch.years=3,a.myChartObject={},a.myChartObject.type="ColumnChart",a.rent=[{v:"Rent"},{v:200},{v:"lightblue"}],a.buy=[{v:"Buy"},{v:a.outputData},{v:"blue"}],a.buyAndRent=[{v:"Duplex"},{v:600},{v:"rgb(255,64,129)"}],a.myChartObject.data={cols:[{id:"options",label:"Options",type:"string"},{id:"dollars",label:"Dollars",type:"number"},{role:"style",type:"string"}],rows:[{c:a.rent},{c:a.buy},{c:a.buyAndRent}]},a.myChartObject.options={title:"Cost Comparison",animation:{duration:1e3,easing:"out"},legend:"none"},a.submitEmail=function(){data={email:a.submit.email,maritalStatus:a.inputData.maritalStatus,zipCode:a.inputData.zipCode,income:a.inputData.income,targetPropertyPrice:a.inputData.targetPropertyPrice,followup:""},i.submitEmail(data),a.submit.email=""}}]),chickAppLogin.controller("LoginController",["$scope","$log","$http","$window",function(a,b,c,d){a.username_login,a.password_login}]),chickAppRegistration.controller("RegistrationController",["$scope","$log","$http","$window","RegisterFactory",function(a,b,c,d,e){a.username_register,a.password_register,a.submit=function(a,b){console.log("Register Button Works"),e.postData(a,b)}}]),chickAppAdmin.factory("AdminService",["$http",function(a){var b={},c=function(c){a.put("/defaults/"+b.defaults._id,c).then(function(){console.log(c)})},d=function(b){console.log("deleteTheContact deleteID: ",b),a.put("/submit/delete/:id",b).then(function(){getContacts()})},e=function(b){a.put("/submit/statusChange/:id",b).then(function(){getContacts()})},f=function(b){a.put("/submit/statusChangeBack/:id",b).then(function(){getContacts()})};return{admin:b,alterDefaults:c,deleteTheContact:d,updateTheContact:e,updateTheContactBack:f}}]),chickApp.factory("ClientService",["$http",function(a){var b={},c=function(b){a.put("/defaults/"+b._id,b).then(function(){d()})},d=function(){a.get("/defaults").then(function(a){b.defaults=a.data[0]})},e=function(b){a.post("/submit",b).then(function(a){console.log("this was the response from the service submitemail",a)})},f={monthlyRentTenantDef:1100,monthlyRentTenantMin:100,monthlyRentTenantMax:1e4,monthlyRentPersonalDef:1200,monthlyRentPersonalMin:200,monthlyRentPersonalMax:1e4,targetPriceDef:266e3,targetPriceMin:5e4,targetPriceMax:5e6,downPaymentPercentageDef:3,downPaymentPercentageMin:0,downPaymentPercentageMax:100,mortgageRateDef:4.25,mortgageRateMin:0,mortgageRateMax:20,yearsAmmoritizedDef:10,yearsAmmoritizedMin:0,yearsAmmoritizedMax:100,incomeDef:8e4,incomeMin:1e4,incomeMax:1e6,mortgageYearsDef:30,mortgageYearsMin:0,mortgageYearsMax:100,vacancyDef:5,vacancyMin:0,vacancyMax:100,propertyTaxDef:1500,propertyTaxMin:0,propertyTaxMax:1e4,assocDuesDef:0,assocDuesMin:0,assocDuesMax:1e4,managementDef:0,managementMin:0,managementMax:1e4,miscDef:1e3,miscMin:0,miscMax:1e5,insuranceAnnualDef:1e3,insuranceAnnualMin:0,insuranceAnnualMax:5e3,utilsDef:100,utilsMin:0,utilsMax:1e4,legalAccountingDef:100,legalAccountingMin:0,legalAccountingMax:1e4,taxBracketDef:28,taxBracketMin:39.9,taxBracketMax:0,repairValueDef:1400,repairValueMin:0,repairValueMax:1e5,yearsDef:5,yearsMin:0,yearsMax:100,zipCode:50466,renterInsuranceDef:50,renterInsuranceMin:0,renterInsuranceMax:4e3,appreciationRateDef:3,appreciationRateMin:0,appreciationRateMax:100,appreciationRateHomeDef:4,appreciationRateHomeMin:0,appreciationRateHomeMax:100,duplexBuyDef:266e3,duplexBuyMin:5e4,duplexBuyMax:5e6},g=function(){a.get("/checkDB").then(function(b){var c=b.data;c===!1?a.post("/defaults",f).then(function(a){d()}):d()})};return g(),{alterDefaults:c,client:b,getDefaults:d,submitEmail:e}}]),chickAppRegistration.factory("RegisterFactory",["$http",function(a){var b=function(b,c){var d={};d.username=b,d.password=c,a.post("/reg",d).success(function(a){console.log("We Dun Did It")})};return{postData:b}}]);